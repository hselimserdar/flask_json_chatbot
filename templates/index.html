<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HSS GPT - AI Chatbot</title>
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='icons/50px-logo.png') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <img src="{{ url_for('static', filename='icons/200px-logo.png') }}" alt="HSS GPT Logo" class="main-logo">
            <h1>HSS GPT</h1>
            <p class="subtitle">Your intelligent AI conversation partner</p>
        </header>
        
        <main class="welcome-section">
            <div class="feature-grid">
                <div class="feature-card">
                    <h3>üí¨ Smart Conversations</h3>
                    <p>Engage in intelligent conversations powered by advanced AI</p>
                </div>
                <div class="feature-card">
                    <h3>üìù Session Management</h3>
                    <p>Keep track of your conversation history across sessions</p>
                </div>
                <div class="feature-card">
                    <h3>üîê Secure Access</h3>
                    <p>Your conversations are private and secure</p>
                </div>
            </div>
            
            <div id="actionButtons" class="action-buttons">
                <!-- Buttons will be populated by JavaScript based on authentication status -->
            </div>
        </main>
        
        <footer>
            <p>&copy; 2025 HSS GPT. All rights reserved.</p>
        </footer>
    </div>

    <script>
        // Check authentication status on page load
        window.addEventListener('load', function() {
            checkAuthenticationStatus();
        });

        function checkAuthenticationStatus() {
            const token = localStorage.getItem('token');
            const actionButtons = document.getElementById('actionButtons');

            if (token && isTokenValid(token)) {
                // User is authenticated - show "Start Chatting" button
                actionButtons.innerHTML = `
                    <a href="/chatbot.html" class="btn btn-primary btn-large">Start Chatting</a>
                    <button onclick="logout()" class="btn btn-outline">Logout</button>
                `;
            } else {
                // User is not authenticated - show login/register options
                actionButtons.innerHTML = `
                    <a href="/login" class="btn btn-primary">Login</a>
                    <a href="/register" class="btn btn-secondary">Sign Up</a>
                    <a href="/guest-chat" class="btn btn-outline">Try as Guest</a>
                `;
            }
        }

        function isTokenValid(token) {
            try {
                // Decode JWT token to check expiration
                const payload = JSON.parse(atob(token.split('.')[1]));
                const currentTime = Math.floor(Date.now() / 1000);
                return payload.exp > currentTime;
            } catch (error) {
                return false;
            }
        }

        function logout() {
            localStorage.removeItem('token');
            checkAuthenticationStatus(); // Refresh the buttons
        }
    </script>
</body>
</html>
